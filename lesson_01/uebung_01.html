<!DOCTYPE html>
<html>
<script type="text/javascript" src="Individual.js"></script>
<script type="text/javascript">

    var evoMod = (function (evo) {
        var myList = [],
            i;

        function isGValid (obj) {
            return obj.gVal >= 300;
        }

        function singlePointRecombination (obj1, obj2) {
            var cutIndex = Math.round(Math.random()*(obj1.binVal.length-2))+ 1,
                part1 = obj1.binVal.substring(0, cutIndex),
                part2 = obj2.binVal.substring(cutIndex),
                partsCombined = part1 + part2,
                newObjs = [];

            part1 = partsCombined.substring(0, partsCombined.length/2);
            part2 = partsCombined.substring(partsCombined.length/2);

            newObjs.push(evo.generateIndividual(part1, part2));

            part1 = obj2.binVal.substring(0, cutIndex);
            part2 = obj1.binVal.substring(cutIndex);
            partsCombined = part1 + part2;
            part1 = partsCombined.substring(0, partsCombined.length/2);
            part2 = partsCombined.substring(partsCombined.length/2);

            newObjs.push(evo.generateIndividual(part1, part2));

            return newObjs;
        }

        // init
        for (i = 0; i < 30; i++) {
            myList.push(evo.generateIndividual());
        }

        // selection
        var myIndividual,
            validIndividuals = [],
            totalRank = 0,
            rankMap = [],
            newSelection = [];

        for (i = 0; i < 30; i++) {
            myIndividual = myList[i];

            if (isGValid(myIndividual)) {
                validIndividuals.push(myIndividual);
            }
        }

        // individual with best fVal has highest rank
        validIndividuals.sort(function(a, b){
            return a.fVal - b.fVal
        });

        // array abhängig von rang befüllen
        for (i = 0; i < validIndividuals.length; i++) {
            for (j = 0; j < i; j++) {
                rankMap.push(i);
            }
        }

        // select new values
        for (i = 0; i < 30; i++) {
            newSelection.push(validIndividuals[rankMap[Math.round(Math.random()*rankMap.length)]]);
        }

        // recombination
        // TODO: do it so you get 30 elements
        var newObjs = singlePointRecombination(newSelection[0], newSelection[1]);
        console.log(newObjs[0].binVal);
        console.log(newObjs[1].binVal);


    }(evoMod || {}))

</script>
</html>